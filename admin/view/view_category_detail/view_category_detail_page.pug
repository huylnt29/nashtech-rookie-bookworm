extends ../global_layout.pug

block content   
     div
          div(class='flex justify-between items-center')
               p(class='font-bold text-xl text-slate-900') CATEGORY: #{categoryDetail.name}
               button(class='bg-red-900 hover:bg-red-700 text-white font-bold py-2 px-4 rounded-xl', onclick=`openDeleteModal(${categoryDetail.id})`) Delete
          div(class='h-4')
          p(class='font-bold text-lg text-gray-600 text-center') Basic information
          div(class='h-3')
          div(class='bg-white py-3 px-8 shadow-lg shadow-slate-200 rounded-2xl')
               +row_text('id', categoryDetail.id)
               +row_text('name', categoryDetail.name, "openEditModal()")
               +row_text('created at', categoryDetail.createdAt)
               +row_text('updated at', categoryDetail.updatedAt)
          div(class='h-8')
          p(class='font-bold text-lg text-gray-600 text-center') Associated books
          div(class='h-3')
          div(class='bg-white p-8 shadow-lg shadow-slate-200 rounded-2xl')
               if categoryDetail.books.length > 0
                    table(class='table w-full')
                         thead(class='table-header-group bg-slate-100')
                              tr(class='table-row')
                                   th(class="table-cell text-left p-3") ID
                                   th(class="table-cell text-left") NAME
                                   th(class="table-cell text-left") PUBLISHED YEAR
                                   th(class="table-cell text-left w-8")          
                         tbody(class="table-row-group")
                              each book in categoryDetail.books
                                        tr(class="table-row hover:bg-slate-50 hover:cursor-pointer group")
                                             td(class="table-cell p-3", onclick=`navigateToBookDetailPage()`) #{book.id}
                                             td(class="table-cell", onclick=`navigateToBookDetailPage()`) #{book.name}
                                             td(class="table-cell", onclick=`navigateToBookDetailPage()`) #{book.publishedYear}
                                             td(class="table-cell")
                                                  i(class="material-icons hidden group-hover:block w-4", onclick=`removeBook(${book.id})`) delete
               else 
                    +announcement('../illustration_no_data.svg', 'You have not associated any book with this category')

     script(type='text/javascript').
          const removeBook = (id) => {
               axios.patch(`/book/${id}`, {
                    categoryId: null
               })
               .then(() => location.reload(true))
          }
     
     include edit_category_modal.pug
     include ../view_category_list/delete_category_modal.pug
